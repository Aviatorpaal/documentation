{{ $id := substr (sha1 .Inner) 0 8 }}
{{ $anchorCount := .Page.Scratch.Get "expand_counter" | default 1 }}
{{ $anchor := printf "expand-%d" $anchorCount }}
{{ .Page.Scratch.Set "expand_counter" (add $anchorCount 1) }}
{{ $permalink := .Page.Permalink }}
{{ $expandLink := printf "%s#%s" $permalink $anchor }}

<div class="expand-container custom-expand" style="display: flex; align-items: center;">
  <div class="gdoc-expand" id="{{ $anchor }}">
    <label class="gdoc-expand__head flex justify-between" for="{{ $id }}-{{ .Ordinal }}">
      <span>{{ default "Expand" (.Get 0) }}</span>
      <span><i class="material-icons" aria-hidden="true" title="Click to expand">expand</i></span>
    </label>
    <input id="{{ $id }}-{{ .Ordinal }}" type="checkbox" class="gdoc-expand__control hidden" />
    <div class="gdoc-markdown--nested gdoc-expand__content">
      {{ .Inner | $.Page.RenderString }}
    </div>
  </div>

  <a data-clipboard-text="{{ $expandLink }}" class="gdoc-page__anchor clip flex align-center" title="{{ printf "Anchor to: %s" $anchor }}" aria-label="{{ printf "Anchor to: %s" $anchor }}" href="{{ $expandLink }}">
    <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
  </a>
</div>
